<!-- src/app/components/expense-tracker/expense-tracker.component.html -->

<!-- Mobile-optimized Hero Section -->
<section class="hero">
  <div class="hero-content">
    <h1>Expense Tracker</h1>
    <p>Track and manage your spending</p>
  </div>
</section>

<!-- Loading State -->
<div class="loading-container" *ngIf="isLoading">
  <div class="spinner"></div>
  <p>Loading your budget data...</p>
</div>

<!-- Main Content -->
<div *ngIf="!isLoading">
  <!-- Budget Summary Card -->
  <div class="budget-card">
    <div class="card-header">
      <h3>{{ currentMonth }} Budget</h3>
      <a routerLink="/budget-settings" class="settings-link">
        <span class="settings-icon">‚öôÔ∏è</span>
        <span class="settings-text">Settings</span>
      </a>
    </div>
    
    <!-- Budget Stats Grid -->
    <div class="budget-stats">
      <div class="stat-item">
        <div class="stat-label">Total Spent</div>
        <div class="stat-value">${{ totalSpent.toFixed(2) }}</div>
      </div>
      
      <div class="stat-item">
        <div class="stat-label">Monthly Budget</div>
        <div class="stat-value">${{ monthlyBudget.toFixed(2) }}</div>
      </div>
      
      <div class="stat-item">
        <div class="stat-label">Remaining</div>
        <div class="stat-value" [class.text-danger]="isBudgetAtRisk()">
          ${{ remainingBudget.toFixed(2) }}
        </div>
      </div>
    </div>
    
    <!-- Budget Progress Bar -->
    <div class="progress-container">
      <div class="progress-bar">
        <div 
          class="progress-fill" 
          [style.width.%]="percentageUsed" 
          [class.high]="percentageUsed > 80"
          [class.medium]="percentageUsed > 60 && percentageUsed <= 80"
        ></div>
      </div>
      <div class="progress-label">{{ percentageUsed }}% of budget used</div>
    </div>
  </div>

  <!-- Categories Section -->
  <div class="categories-section" *ngIf="expenseCategories.length > 0">
    <div class="section-header">
      <h3>Spending by Category</h3>
    </div>
    
    <!-- Categories Grid -->
    <div class="categories-grid">
      <div 
        *ngFor="let category of expenseCategories" 
        class="category-card"
      >
        <div class="category-icon" [style.background-color]="category.color">
          {{ category.icon }}
        </div>
        <div class="category-details">
          <div class="category-header">
            <span class="category-name">{{ category.name }}</span>
            <span class="category-amount">${{ category.amount.toFixed(2) }}</span>
          </div>
          <div class="category-progress">
            <div 
              class="category-bar" 
              [style.width.%]="category.percentage"
              [style.background-color]="category.color"
            ></div>
          </div>
          <div class="category-stats">
            <span>{{ category.percentage }}% of total</span>
            <span>{{ category.transactions }} transactions</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- No Categories Message -->
  <div class="empty-state" *ngIf="expenseCategories.length === 0">
    <div class="empty-icon">üìä</div>
    <h3>No Spending Data</h3>
    <p>Scan receipts to start tracking your expenses</p>
    <button class="action-btn primary" routerLink="/homepage">Scan Receipt</button>
  </div>

  <!-- Recent Transactions -->
  <div class="transactions-section" *ngIf="recentTransactions.length > 0">
    <div class="section-header">
      <h3>Recent Transactions</h3>
    </div>
    
    <div class="transactions-list">
      <div 
        *ngFor="let transaction of recentTransactions" 
        class="transaction-card"
        routerLink="/past-receipts"
      >
        <div class="transaction-icon">
          {{ transaction.icon }}
        </div>
        <div class="transaction-details">
          <div class="transaction-merchant">{{ transaction.merchant }}</div>
          <div class="transaction-info">
            <span class="transaction-category">{{ transaction.category }}</span>
            <span class="transaction-date">{{ getFormattedDate(transaction.date) }}</span>
          </div>
        </div>
        <div class="transaction-amount">${{ transaction.amount.toFixed(2) }}</div>
      </div>
    </div>
    
    <a routerLink="/past-receipts" class="view-all-link">
      <span>View All Transactions</span>
      <span class="arrow-icon">‚Üí</span>
    </a>
  </div>
  
  <!-- Monthly Spending History -->
  <div class="history-section" *ngIf="monthlyHistory.length > 0">
    <div class="section-header">
      <h3>Monthly Spending</h3>
    </div>
    
    <div class="chart-container">
      <div class="chart-bars">
        <div *ngFor="let month of monthlyHistory" class="chart-bar">
          <div 
            class="bar-fill" 
            [style.height.px]="getChartBarHeight(month.amount)"
          ></div>
          <div class="bar-label">{{ month.month.split(' ')[0].substring(0, 3) }}</div>
          <div class="bar-value">${{ month.amount.toFixed(0) }}</div>
        </div>
      </div>
    </div>
  </div>
</div>